import{u as I}from"./vue-router-BwYk-uVy.js";import{u as N}from"./vuex-ZndIkrpf.js";import{O as T}from"./@fancyapps-CYgxqxvx.js";import{_ as D}from"./index-Cyanj4bI.js";import{u as d,t as F,v as m,F as O,aV as B,s as E,b9 as f,aS as h,aC as S,as as w,bC as L,aX as q,aK as i,av as z}from"./@vue-Cn0pJ44W.js";import"./@kangc-ITgKWXLB.js";import"./@babel-BgIvLCQ5.js";import"./vue-tkVpdOni.js";import"./@vuepress-3yONQRlZ.js";import"./copy-to-clipboard-C0dvYkVd.js";import"./toggle-selection-DGa8lynz.js";import"./highlight.js-DnWd8IMV.js";const J={setup(){const c=I(),v=N(),_=JSON.parse(sessionStorage.getItem("markdownFiles")).find(e=>e.title===c.params.title).date,t=h({title:c.params.title||"无标题",date:new Date(_).toLocaleDateString("zh-CN",{timeZone:"Asia/Shanghai"})||"未知日期",content:""}),u=h([]),l=h(null),p=h(!0),s=()=>{p.value=window.innerWidth>=1024};window.addEventListener("resize",s),S(s);const g=e=>{const n=sessionStorage.getItem(`article-${e}`);return n?JSON.parse(n):null},k=()=>{console.log("复制成功")},x=async e=>{const n=g(e);if(n)t.value=n;else{const o=v.state.markdownFiles.find(a=>a.title===e);o?(t.value={title:o.title,date:t.value.date,content:o.content},sessionStorage.setItem(`article-${e}`,JSON.stringify(t.value))):t.value.content="文章未找到"}},A=e=>{const n=l.value,{lineIndex:o}=e,a=n.$el.querySelector(`[data-v-md-line="${o}"]`);a&&n.scrollToTarget({target:a,scrollContainer:window,top:60})},y=()=>{const e=l.value;if(!e)return;const n=e.$el;if(!n)return;const o=n.querySelectorAll("h1, h2, h3, h4, h5, h6"),a=Array.from(o).filter(r=>r.innerText.trim());if(!a.length)return;const b=Array.from(new Set(a.map(r=>r.tagName))).sort();u.value=a.map(r=>({title:r.innerText,lineIndex:r.getAttribute("data-v-md-line"),indent:b.indexOf(r.tagName)}))},C=()=>{var n;const e=(n=l.value)==null?void 0:n.$el.querySelectorAll("img");e==null||e.forEach(o=>{o.setAttribute("data-fancybox","gallery")}),T.bind('[data-fancybox="gallery"]',{})};return S(()=>{c.params.title&&x(c.params.title).then(()=>{w(()=>{y(),C()})})}),L(()=>t.value.content,e=>{e&&w(()=>{y(),C()})}),{article:t,titles:u,handleCopyCodeSuccess:k,handleAnchorClick:A,previewRef:l,isDesktop:p}}},R={class:"content-wrapper"},V={key:0,class:"anchor-navigation"},$=["onClick"],K={style:{cursor:"pointer"}},M={class:"content-container"},W={class:"content-header"},X={class:"article-title"},Z={class:"article-date"},j={key:1};function G(c,v,_,t,u,l){const p=q("v-md-preview");return i(),d("div",R,[t.isDesktop?(i(),d("nav",V,[(i(!0),d(O,null,B(t.titles,s=>(i(),d("div",{key:s.lineIndex,style:z({paddingLeft:`${s.indent*20}px`}),class:"anchor-item",onClick:g=>t.handleAnchorClick(s)},[m("a",K,f(s.title),1)],12,$))),128))])):F("",!0),m("div",M,[m("header",W,[m("h1",X,f(t.article.title),1),m("p",Z,"发布日期："+f(t.article.date),1)]),t.article.content?(i(),E(p,{ref:"previewRef",onCopyCodeSuccess:t.handleCopyCodeSuccess,text:t.article.content,key:t.article.title},null,8,["onCopyCodeSuccess","text"])):(i(),d("p",j,"加载中..."))])])}const ie=D(J,[["render",G],["__scopeId","data-v-2fbe09b0"]]);export{ie as default};
